machine:
  ghc:
    version: 7.8.3
  environment:
    PATH: $HOME/$CIRCLE_PROJECT_REPONAME/.cabal-sandbox/bin:$PATH

general:
  artifacts:
    - report.html
    - dist/test/

dependencies:
  cache_directories:
    - "~/bot/.cabal-sandbox"
  override:
    - cabal update
    - cabal sandbox init
    - cabal install --only-dependencies --enable-tests -j2
    - cabal install hlint:
        timeout: 3000

test:
  override:
    - hlint --report -- $(pwd); true
    - cabal configure --enable-tests
    - cabal build:
        timeout: 3000
    - cabal test --show-details=always:
        timeout: 3000
